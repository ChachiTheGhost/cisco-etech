---
language: python
python:
  - "3.6"

# Install python packages for ansible and linters.
# Install a minimal TexLive installation for LaTeX support.
install:
  # - "sudo apt-get install chktex xzdec texlive-latex-base -y"
  - "wget http://mirror.ctan.org/systems/texlive/tlnet/install-tl-unx.tar.gz"
  - "tar -xzvf install-tl-unx.tar.gz"
  - "cd install-tl-20*"
  - "./install-tl -profile texlive.profile"
  - "PATH=$PATH:/usr/local/texlive/2018/bin/x86_64-linux"
  - "tlmgr --version"
  - >-
    tlmgr install
    booktabs caption minted chktex
	fvextra etoolbox fancyvrb xcolor upquote lineno ifplatform xstring framed float
  - "pip install -r requirements.txt"

# Execute linting tests before running the main playbook.
# chktex apparently always returns rc=0 
# draft-mode will not render images, and provides detailed fail log
before_script:
  - "make lint"
  - "make draft"

# Make the PDF itself, including images
script:
  - "make pdf"
...
